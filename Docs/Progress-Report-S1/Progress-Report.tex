\documentclass[onecolumn, draftclsnofoot,10pt, compsoc]{IEEEtran}
\usepackage{graphicx}
\usepackage{url}
\usepackage{setspace}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{float}
\usepackage{longtable}

\usepackage{geometry}
\geometry{textheight=9.5in, textwidth=7in}

% Listings settings for swift taken from chriseidhof GitHub
\lstdefinelanguage{swift}
{
  morekeywords={
    func,if,then,else,for,in,while,do,switch,case,default,where,break,continue,fallthrough,return,
    typealias,struct,class,enum,protocol,var,func,let,get,set,willSet,didSet,inout,init,deinit,extension,
    subscript,prefix,operator,infix,postfix,precedence,associativity,left,right,none,convenience,dynamic,
    final,lazy,mutating,nonmutating,optional,override,required,static,unowned,safe,weak,internal,
    private,public,is,as,self,unsafe,dynamicType,true,false,nil,Type,Protocol,
  },
  morecomment=[l]{//}, % l is for line comment
  morecomment=[s]{/*}{*/}, % s is for start and end delimiter
  morestring=[b]" % defines that strings are enclosed in double quotes
}

\definecolor{keyword}{HTML}{BA2CA3}
\definecolor{string}{HTML}{D12F1B}
\definecolor{comment}{HTML}{008400}

\lstset{
  language=swift,
  basicstyle=\ttfamily,
  showstringspaces=false, % lets spaces in strings appear as real spaces
  columns=fixed,
  keepspaces=true,
  keywordstyle=\color{keyword},
  stringstyle=\color{string},
  commentstyle=\color{comment},
}

% 1. Fill in these details
\def \CapstoneTeamName{Manovacumeter Team}
\def \CapstoneTeamNumber{ 20}
\def \GroupMemberOne{Cade Raichart}
\def \GroupMemberTwo{Daniel Kato}
\def \GroupMemberThree{Nathan Shepherd}
\def \CapstoneProjectName{ISS Barometer App }
\def \CapstoneSponsorCompany{NASA}
\def \CapstoneSponsorPerson{Don Pettit}

% 2. Uncomment the appropriate line below so that the document type works
\def \DocType{Progress Report}

\newcommand{\NameSigPair}[1]{\par
\makebox[2.75in][r]{#1} \hfil 	\makebox[3.25in]{\makebox[2.25in]{\hrulefill} \hfill		\makebox[.75in]{\hrulefill}}
\par\vspace{-12pt} \textit{\tiny\noindent
\makebox[2.75in]{} \hfil		\makebox[3.25in]{\makebox[2.25in][r]{Signature} \hfill	\makebox[.75in][r]{Date}}}}
% 3. If the document is not to be signed, uncomment the RENEWcommand below
%\renewcommand{\NameSigPair}[1]{#1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\begin{titlepage}
    \pagenumbering{gobble}
    \begin{singlespace}
    	\includegraphics[height=4cm]{coe_v_spot1}
        \hfill
        % 4. If you have a logo, use this includegraphics command to put it on the coversheet.
        %\includegraphics[height=4cm]{NASA}
        \par\vspace{.2in}
        \centering
        \scshape{
            \huge CS Capstone \DocType \par
            {\large\today}\par
            \vspace{.5in}
            \textbf{\Huge\CapstoneProjectName}\par
            \vfill
            {\large Prepared for}\par
            \Huge \CapstoneSponsorCompany\par
            \vspace{5pt}
            {\Large\NameSigPair{\CapstoneSponsorPerson}\par}
            {\large Prepared by }\par
            Group\CapstoneTeamNumber\par
            % 5. comment out the line below this one if you do not wish to name your team
            %\CapstoneTeamName\par
            \vspace{5pt}
            {\Large
                \NameSigPair{\GroupMemberTwo}\par
            }
            \vspace{20pt}
        }
        \begin{abstract}
        % 6. Fill in your abstract
        The International Space Station, the conglomerate work of multiple national space associations, including NASA, requires precision devices to monitor the many aspects of space life.
        One very important aspect for the success of life in near vacuum is sustained air pressure inside the modules.
        This air pressure is monitored by mechanical barometers, called Manovacometers, which must be visually monitored, and are no longer available.
        The \CapstoneProjectName seeks to provide a suitable replacement for the current barometer device aboard the International Space Station.
        This document will update the reader on our progress, from the last Winter term progress report.
        This document should provide a clear picture of where the project stands, halfway through the Spring term, and nearing the end of the allotted year.
        \end{abstract}
    \end{singlespace}
\end{titlepage}
\newpage
\pagenumbering{arabic}
\tableofcontents
% 7. uncomment this (if applicable). Consider adding a page break.
%\listoffigures
%\listoftables
\clearpage

% 8. now you write!
\section{Project Purpose}
The ISS Barometer Application will be used on the ISS to measure and track air pressure.
The crew members aboard the ISS are currently reliant on mechanical barometers to take critical readings during leaks, or rapid depressurization events.
These leaks, caused by orbital debris, must be found and patched or the crew would need to evacuate.
Our application will improve on the mechanical barometers by providing clear and accurate pressure readings through the iPads on-board barometer sensor.
Readouts and measurements will be presented in a easy-to-read fashion that will allow users to quickly gauge the important details.
In further iterations, we plan to implement contextualized audio data readouts by using the t-Res document and a simple Swift api \cite{probStat}.

\section{Project Goals}
As mentioned above the application we are making will provide ISS crew members with an accurate and efficient pressure reading.
Our required features follow that purpose and are listed below:
\begin{itemize}
\item[V1:] Data Screen with initial pressure, current pressure, start/stop button, time stamp, pressure change (measured in sec / mmHg)
\item[V1:] Graph Screen with plot pressure as a function of time
\item[V1:] Additional settings menu that includes plot scale, scroll functionality, orientation, decimal point, as well as other other units of measure for pressure
\item[V1:] All items will be optimized for efficient reading and clear interface
\item[V2:] Graph will have pinch to zoom functionality, scaling options (to be set in settings)
\item[V2:] Graph will be able to be exported as a csv, excel readable file
\item[V2:] Graph can be compared to t-Res table, to measure time remaining
\item[V2:] Audio data readouts that will provide specific information at regular intervals
\end{itemize}

Along with these specific features, the application that we create must be efficient and clear, as decided by the users.
The application will be used in challenging situations and must be clear and easy to understand, so that the data can be conveyed quickly and without confusion.
From the listed project goals, we have sufficiently finished with V1, and have started implementing portions of V2, while trying to finalize our V1 progress.


\section{Current Status}
    We are currently updating the UI and adding a few features that Don requested in response to seeing our alpha version of the app.
    This alpha version includes a main UI with readings of current pressure and time, change in pressure since button press and time of press, average $\frac{\Delta p}{\Delta t}$ and $\frac{\Delta t}{\Delta p}$ since button press and time of press, and a chart of pressure over time.
    The delta reading has a corresponding button that when pressed updates the display with the change in pressure since the last time the button was pressed.
    Similarly, the average $\frac{\Delta p}{\Delta t}$ and $\frac{\Delta t}{\Delta p}$ readings have a corresponding buttons that when pressed updates the display with the average $\frac{\Delta p}{\Delta t}$ and $\frac{\Delta t}{\Delta p}$ since the last button press.

    The chart is currently displays the current pressure as a function of time with the ability to pinch to zoom.
    The x-axis displays the time of the reading in the format determined for the system in the system settings app.
    Whenever the units for the graph are changed, the y-axis points are converted to reflect the new unit of measurement while maintaining the shape of the graph.

    The settings page currently allows for the configuration of units, significant digits, orientation, and graph style.
    The available units are mmHg, psi, kPa, and atm.
    The significant digit allow for between 0 and 10 significant digits.
    The orientation allows for the orientation to be up, down, left, or right compared to the default orientation (camera above display and home button below).

    \subsection{Remaining Tasks}
        The application still needs to have the UI updated, before having a complete alpha version.
        Once the alpha has been accepted, we will incorporate the existing T-res chart into our application as well as a reading that displays the amount of time before an evacuation is necessary.
        We will also incorporate a vocal readout of the amount of time left, and the ability to lock the screen from touch input unless a lock icon is pressed again.
        We also need to redesign the app icon to depict the ISS with a hole in it with air escaping.

\section{Problems Faced}
    One of the problems I ran into was getting the orientation to lock.
    There was not much information on the web about programmatically locking the orientation in Swift 4.
    I eventually found out that you can set the orientation with a call to \texttt{UIDevice.current.setValue(<orientationInt>, forKey: "orientation")}.
    
    Other issues faced included the tRes accuracy and client side errors.
    The tRes accuracy issues were due to the miscalculation of the tRes.
    It was assumed that the depressurization rate was a constant rate, and the tRes could be represented with $tRes=(currentPressure - safetyBuffer) / \frac{\Delta P}{\Delta t}$.
    This is a false assumption, as our client informed us, and the method we used to derive the tRes is not accurate enough for the use cases in the ISS.
    The other issue faced was difficulties on our clients side.
    Their computer crashed, which made it impossible for them to test our application in its later iterations.
    This led to very little feedback from our client, and only recently have we been able to update them to our progress.
    This has been remedied and they have since been able to demo our project.
    Their input is critical, as they have firsthand experience in space, which is our target use case.
    With their input, we've planned several UI changes, as mentioned before, as well as a redefinition of the tRes calculation.

\section{Relevant and Interesting Details}
    After completing the settings UI, we needed the settings to persist from use to use.
    To solution to this problem was UserDefaults which allows you to store serialized objects and retrieve them by an ID later is the class conforms to the \texttt{Codable} class.
    The code to implement this was very easy to read and implement and is as follows:

\begin{lstlisting}
// Settings Object
class Settings: Codable {
    var units = "mmHg"
    var sigFigs = 4
    var orientation = "Right"
    var slidingScale = false
    var slidingScaleThreshold = 20
    var windowSize = 50
}

// Store Settings Object
UserDefaults.standard.set(try? PropertyListEncoder().encode(settings), forKey: "Settings")

// Retrieve Settings Object
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
    if let data = UserDefaults.standard.value(forKey: "Settings") as? Data {
        settings = try? PropertyListDecoder().decode(Settings.self, from: data)
    }
    if settings == nil {
        settings = Settings()
    }
    return true
}

\end{lstlisting}

\section{Retrospective}
\begin{center}
	\begin{longtable}{| l | p{0.28\linewidth} | p{0.28\linewidth} | p{0.28\linewidth} |}
		\hline
		& Positives & Deltas & Actions \\ \hline
    Week 1 & During Spring break, axis labels were finalized & An article report, client wasn't able to run application & Work on the article was started \\ \hline
	Week 2 & Signed up for Expo & Article and poster were due & Article was completed \\ \hline
	Week 3 & Poster was finalized & Poster had some font issues & Font issues were resolved, poster was submitted \\ \hline
	Week 4 & Work started on the tRes display & Need to meet with Don to get feedback & Set up meeting with Don \\ \hline
  Week 5 & tRes was completed & Realized that tRes wasn't linear & tRes needs to be calculated differently, progress report and presentation completed \\ \hline
\end{longtable}
\end{center}

\newpage
\bibliographystyle{IEEEtran}
\bibliography{bibliography}

\end{document}
